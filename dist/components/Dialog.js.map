{"version":3,"sources":["../../src/components/Dialog.js"],"names":["Dialog","options","init","self","panel","inner","getMain","closeOnTouchBlack","bindEvents","apply","main","$","getTemplate","titleHtml","getClass","title","bodyHtml","body","footerHtml","footer","skin","content","find","html","show","hide","suffix","Popup","handlers","on","e","opttype","data","callHandler","handler","autoRemove","push","forEach","item","index","removeHandler","alertDialog","addHandler","alert","setBody","setTitle","confirmDialog","confirm","promptDialog","prompt","placeholder","promptInput","value"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AACA;;;;IAEaA,M,WAAAA,M;AACT,oBAAYC,OAAZ,EAAqB;AAAA;;AACjB,aAAKA,OAAL,GAAeA,OAAf;AACA,aAAKC,IAAL;AACH;;;;+BAEM;AACH,gBAAIC,OAAO,IAAX;AACA,gBAAIF,UAAUE,KAAKF,OAAnB;;AAEAE,iBAAKC,KAAL,GAAa,iBAAU;AACnBC,uBAAOF,KAAKG,OAAL,EADY;AAEnBC,mCAAmB;AAFA,aAAV,CAAb;;AAKAN,oBAAQO,UAAR,IAAsBP,QAAQO,UAAR,CAAmBC,KAAnB,CAAyBN,IAAzB,CAAtB;AAEH;;;kCAES;AACN,iBAAKO,IAAL,GAAYC,EAAE,KAAKC,WAAL,EAAF,CAAZ;AACA,mBAAO,KAAKF,IAAZ;AACH;;;sCAEa;;AAEV,gBAAIP,OAAO,IAAX;AACA,gBAAIF,UAAUE,KAAKF,OAAnB;;AAEA,gBAAIY,2CACcV,KAAKW,QAAL,CAAc,OAAd,CADd,WACyCb,QAAQc,KAAR,IAAiB,EAD1D,sBAAJ;;AAIA,gBAAIC,8CACkBb,KAAKW,QAAL,CAAc,MAAd,CADlB,WAC4Cb,QAAQgB,IAAR,IAAgB,EAD5D,0BAAJ;;AAIA,gBAAIC,4CACcf,KAAKW,QAAL,CAAc,QAAd,CADd,WAC0Cb,QAAQkB,MAAR,IAAkB,EAD5D,sBAAJ;;AAKA,kDACkBhB,KAAKW,QAAL,EADlB,SACqCb,QAAQmB,IAD7C,4BAEUP,SAFV,GAEsBG,QAFtB,GAEiCE,UAFjC;AAKH;;;gCAEOG,O,EAAS;AACb,iBAAKX,IAAL,CAAUY,IAAV,CAAe,MAAM,KAAKR,QAAL,CAAc,MAAd,CAArB,EAA4CS,IAA5C,CAAiDF,OAAjD;AACH;;;iCAEQN,K,EAAO;AACZ,iBAAKL,IAAL,CAAUY,IAAV,CAAe,MAAM,KAAKR,QAAL,CAAc,OAAd,CAArB,EAA6CS,IAA7C,CAAkDR,KAAlD;AACH;;;+BAEM;AACH,iBAAKX,KAAL,CAAWoB,IAAX;AACH;;;+BAEM;AACH,iBAAKpB,KAAL,CAAWqB,IAAX;AACH;;;iCAEQC,M,EAAQ;AACb,mBAAO,sBAAsBA,SAAU,MAAMA,MAAhB,GAA0B,EAAhD,CAAP;AACH;;;;;IAKQC,K,WAAAA,K;;;AACT,mBAAY1B,OAAZ,EAAqB;AAAA;;AAAA,wIACXA,OADW;;AAEjB,cAAK2B,QAAL,GAAgB,EAAhB;AACA,cAAKpB,UAAL;AAHiB;AAIpB;;;;qCAEY;AACT,gBAAIL,OAAO,IAAX;AACAQ,cAAER,KAAKO,IAAP,EAAaY,IAAb,CAAkB,MAAMnB,KAAKW,QAAL,CAAc,QAAd,CAAxB,EACKe,EADL,CACQ,OADR,EACiB,QADjB,EAC2B,UAAUC,CAAV,EAAa;;AAEhC,oBAAIC,UAAUpB,EAAE,IAAF,EAAQqB,IAAR,CAAa,SAAb,CAAd;;AAEA,oBAAID,OAAJ,EAAa;AACT5B,yBAAK8B,WAAL,CAAiBF,OAAjB;AACH;AAEJ,aATL;AAUH;;;mCAEUA,O,EAASG,O,EAA0B;AAAA,gBAAjBC,UAAiB,uEAAN,IAAM;;AAC1C,gBAAIhC,OAAO,IAAX;AACA,gBAAIyB,WAAWzB,KAAKyB,QAApB;;AAEAA,qBAASG,OAAT,IAAoBH,SAASG,OAAT,KAAqB,EAAzC;AACAG,oBAAQC,UAAR,GAAqBA,UAArB;AACAP,qBAASG,OAAT,EAAkBK,IAAlB,CAAuBF,OAAvB;AACA,mBAAO/B,IAAP;AACH;;;sCAEa4B,O,EAASG,O,EAAS;AAC5B,gBAAIN,WAAW,KAAKA,QAApB;;AAEA,gBAAIM,OAAJ,EAAa;AACTN,yBAASG,OAAT,EAAkBM,OAAlB,CACI,UAACC,IAAD,EAAOC,KAAP,EAAiB;AACb,wBAAID,SAASJ,OAAb,EAAsB;AAClBN,iCAASG,OAAT,EAAkBQ,KAAlB,IAA2B,IAA3B;AACH;AACJ,iBALL;AAOH,aARD,MASK;AACDX,yBAASG,OAAT,IAAoB,EAApB;AACH;AACJ;;;oCAEWA,O,EAAS;AACjB,gBAAI5B,OAAO,IAAX;AACA,gBAAIyB,WAAWzB,KAAKyB,QAApB;;AAEAA,qBAASG,OAAT,EAAkBM,OAAlB,CACI,UAACC,IAAD,EAAU;AACN,oBAAIA,IAAJ,EAAU;AACNA,yBAAK7B,KAAL,CAAWN,IAAX;;AAEA,wBAAImC,KAAKH,UAAT,EAAqB;AACjBhC,6BAAKqC,aAAL,CAAmBT,OAAnB,EAA4BO,IAA5B;AACH;AACJ;AACJ,aATL;AAYH;;;EAhEsBtC,M;;AAqE3B,IAAMyC,cAAc,IAAId,KAAJ,CAAU;AAC1BR,qFAD0B;AAI1BC,UAAM;AAJoB,CAAV,CAApB;;AAOAqB,YAAYC,UAAZ,CAAuB,IAAvB,EAA6B,YAAY;AACrC,SAAKjB,IAAL;AACH,CAFD,EAEG,KAFH;;AAIO,IAAMkB,wBAAQ,SAARA,KAAQ,CAACtB,OAAD,EAAuB;AAAA,QAAbN,KAAa,uEAAP,EAAO;;AACxC0B,gBAAYG,OAAZ,CAAoBvB,OAApB;AACAoB,gBAAYI,QAAZ,CAAqB9B,KAArB;AACA0B,gBAAYjB,IAAZ;;AAEA,WAAOiB,WAAP;AACH,CANM;;AASP,IAAMK,gBAAgB,IAAInB,KAAJ,CAAU;AAC5BR,uMAD4B;AAK5BC,UAAM;AALsB,CAAV,CAAtB;;AAQA0B,cAAcJ,UAAd,CAAyB,IAAzB,EAA+B,YAAY;AACvC,SAAKjB,IAAL;AACH,CAFD,EAEG,KAFH;;AAIO,IAAMsB,4BAAU,SAAVA,OAAU,CAAC1B,OAAD,EAAuB;AAAA,QAAbN,KAAa,uEAAP,EAAO;;AAC1C+B,kBAAcF,OAAd,CAAsBvB,OAAtB;AACAyB,kBAAcD,QAAd,CAAuB9B,KAAvB;AACA+B,kBAActB,IAAd;;AAEA,WAAOsB,aAAP;AACH,CANM;;AAQP,IAAME,eAAe,IAAIrB,KAAJ,CAAU;AAC3BR,mNAD2B;AAK3BC,UAAM;AALqB,CAAV,CAArB;AAOA4B,aAAaN,UAAb,CAAwB,IAAxB,EAA8B,YAAY;AACtC,SAAKjB,IAAL;AACH,CAFD,EAEG,KAFH;;AAIO,IAAMwB,0BAAS,SAATA,MAAS,CAACC,WAAD,EAA2B;AAAA,QAAbnC,KAAa,uEAAP,EAAO;;AAC7CiC,iBAAaJ,OAAb,CAAqB,qCAAqCM,WAArC,GAAmD,eAAxE;AACAF,iBAAaH,QAAb,CAAsB9B,KAAtB;AACAiC,iBAAaxB,IAAb;;AAEA,WAAOwB,YAAP;AACH,CANM;;AAQA,IAAMG,oCAAc,SAAdA,WAAc,CAACC,KAAD,EAAqB;AAAA,QAAbrC,KAAa,uEAAP,EAAO;;AAC5CiC,iBAAaJ,OAAb,CAAqB,+BAA+BQ,KAA/B,GAAuC,KAA5D;AACAJ,iBAAaH,QAAb,CAAsB9B,KAAtB;AACAiC,iBAAaxB,IAAb;;AAEA,WAAOwB,YAAP;AACH,CANM","file":"Dialog.js","sourcesContent":["\nimport { Panel } from './Panel';\n\nexport class Dialog {\n    constructor(options) {\n        this.options = options;\n        this.init();\n    }\n\n    init() {\n        let self = this;\n        let options = self.options;\n\n        self.panel = new Panel({\n            inner: self.getMain(),\n            closeOnTouchBlack: true\n        });\n\n        options.bindEvents && options.bindEvents.apply(self);\n\n    }\n\n    getMain() {\n        this.main = $(this.getTemplate());\n        return this.main;\n    }\n\n    getTemplate() {\n\n        let self = this;\n        let options = self.options;\n\n        let titleHtml = `\n            <div class=\"${self.getClass('title')}\">${options.title || ''}</div>\n        `;\n\n        let bodyHtml = `\n                <div class=\"${self.getClass('body')}\">${options.body || ''}</div>\n            `;\n\n        let footerHtml = `\n            <div class=\"${self.getClass('footer')}\">${options.footer || ''}</div>\n        `;\n\n\n        return `\n            <div class=\"${self.getClass()} ${options.skin}\">\n                ${titleHtml}${bodyHtml}${footerHtml}\n            </div>\n        `;\n    }\n\n    setBody(content) {\n        this.main.find('.' + this.getClass('body')).html(content);\n    }\n\n    setTitle(title) {\n        this.main.find('.' + this.getClass('title')).html(title);\n    }\n\n    show() {\n        this.panel.show();\n    }\n\n    hide() {\n        this.panel.hide();\n    }\n\n    getClass(suffix) {\n        return 'component-dialog' + (suffix ? ('-' + suffix) : '');\n    }\n\n}\n\n\nexport class Popup extends Dialog {\n    constructor(options) {\n        super(options);\n        this.handlers = {};\n        this.bindEvents();\n    }\n\n    bindEvents() {\n        let self = this;\n        $(self.main).find('.' + self.getClass('footer'))\n            .on('click', 'button', function (e) {\n\n                let opttype = $(this).data('opttype');\n\n                if (opttype) {\n                    self.callHandler(opttype);\n                }\n\n            });\n    }\n\n    addHandler(opttype, handler, autoRemove=true) {\n        let self = this;\n        let handlers = self.handlers;\n\n        handlers[opttype] = handlers[opttype] || [];\n        handler.autoRemove = autoRemove;\n        handlers[opttype].push(handler);\n        return self;\n    }\n\n    removeHandler(opttype, handler) {\n        let handlers = this.handlers;\n\n        if (handler) {\n            handlers[opttype].forEach(\n                (item, index) => {\n                    if (item === handler) {\n                        handlers[opttype][index] = null;\n                    }\n                }\n            );\n        }\n        else {\n            handlers[opttype] = [];\n        }\n    }\n\n    callHandler(opttype) {\n        let self = this;\n        let handlers = self.handlers;\n\n        handlers[opttype].forEach(\n            (item) => {\n                if (item) {\n                    item.apply(self);\n\n                    if (item.autoRemove) {\n                        self.removeHandler(opttype, item);\n                    }\n                }\n            }\n        );\n\n    }\n\n}\n\n\nconst alertDialog = new Popup({\n    footer: `\n        <button type=\"button\" data-opttype=\"ok\">好</button>\n    `,\n    skin: 'alert'\n});\n\nalertDialog.addHandler('ok', function () {\n    this.hide();\n}, false);\n\nexport const alert = (content, title='') => {\n    alertDialog.setBody(content);\n    alertDialog.setTitle(title);\n    alertDialog.show();\n\n    return alertDialog;\n};\n\n\nconst confirmDialog = new Popup({\n    footer: `\n        <button type=\"button\" class=\"btn-default btn\" data-opttype=\"no\">否</button>\n        <button type=\"button\" class=\"btn-primary btn\" data-opttype=\"yes\">是</button>\n    `,\n    skin: 'confirm'\n});\n\nconfirmDialog.addHandler('no', function () {\n    this.hide();\n}, false);\n\nexport const confirm = (content, title='') => {\n    confirmDialog.setBody(content);\n    confirmDialog.setTitle(title);\n    confirmDialog.show();\n\n    return confirmDialog;\n};\n\nconst promptDialog = new Popup({\n    footer: `\n        <button type=\"button\" class=\"btn-default btn\" data-opttype=\"no\">取消</button>\n        <button type=\"button\" class=\"btn-primary btn\" data-opttype=\"yes\">确定</button>\n    `,\n    skin: 'prompt'\n});\npromptDialog.addHandler('no', function () {\n    this.hide();\n}, false);\n\nexport const prompt = (placeholder, title='') => {\n    promptDialog.setBody('<textarea rows=\"4\" placeholder=\"' + placeholder + '\"></textarea>');\n    promptDialog.setTitle(title);\n    promptDialog.show();\n\n    return promptDialog;\n};\n\nexport const promptInput = (value, title='') => {\n    promptDialog.setBody('<input type=\"text\" value=\"' + value + '\"/>');\n    promptDialog.setTitle(title);\n    promptDialog.show();\n\n    return promptDialog;\n};\n"]}